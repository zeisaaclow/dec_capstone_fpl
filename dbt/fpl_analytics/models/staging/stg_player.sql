-- STAGING ELEMENTS
SELECT
    player.value:chance_of_playing_next_round::INT AS chance_of_playing_next_round,
    player.value:chance_of_playing_this_round::INT AS chance_of_playing_this_round,
    player.value:code::VARCHAR AS code,
    player.value:cost_change_event::INT AS cost_change_event,
    player.value:cost_change_event_fall::INT AS cost_change_event_fall,
    player.value:cost_change_start::INT AS cost_change_start,
    player.value:cost_change_start_fall::INT AS cost_change_start_fall,
    player.value:dreamteam_count::INT AS dreamteam_count,
    player.value:element_type::VARCHAR AS element_type,
    player.value:ep_next::FLOAT AS ep_next,
    player.value:ep_this::FLOAT AS ep_this,
    player.value:event_points::INT AS event_points,
    player.value:first_name::VARCHAR AS first_name,
    player.value:form::FLOAT AS form,
    player.value:id::VARCHAR AS id,
    player.value:in_dreamteam::BOOLEAN AS in_dreamteam,
    player.value:news::VARCHAR AS news,
    player.value:news_added::TIMESTAMP_TZ AS news_added,
    player.value:now_cost::INT AS now_cost,
    player.value:photo::VARCHAR AS photo,
    player.value:points_per_game::FLOAT AS points_per_game,
    player.value:second_name::VARCHAR AS second_name,
    player.value:selected_by_percent::FLOAT AS selected_by_percent,
    player.value:special::BOOLEAN AS special,
    player.value:squad_number::INT AS squad_number,
    player.value:status::VARCHAR AS status,
    player.value:team::VARCHAR AS team,
    player.value:team_code::VARCHAR AS team_code,
    player.value:total_points::INT AS total_points,
    player.value:transfers_in::INT AS transfers_in,
    player.value:transfers_in_event::INT AS transfers_in_event,
    player.value:transfers_out::INT AS transfers_out,
    player.value:transfers_out_event::INT AS transfers_out_event,
    player.value:value_form::FLOAT AS value_form,
    player.value:value_season::FLOAT AS value_season,
    player.value:web_name::VARCHAR AS web_name,
    player.value:minutes::INT AS minutes,
    player.value:goals_scored::INT AS goals_scored,
    player.value:assists::INT AS assists,
    player.value:clean_sheets::INT AS clean_sheets,
    player.value:goals_conceded::INT AS goals_conceded,
    player.value:own_goals::INT AS own_goals,
    player.value:penalties_saved::INT AS penalties_saved,
    player.value:penalties_missed::INT AS penalties_missed,
    player.value:yellow_cards::INT AS yellow_cards,
    player.value:red_cards::INT AS red_cards,
    player.value:saves::INT AS saves,
    player.value:bonus::INT AS bonus,
    player.value:bps::INT AS bps,
    player.value:influence::FLOAT AS influence,
    player.value:creativity::FLOAT AS creativity,
    player.value:threat::FLOAT AS threat,
    player.value:ict_index::FLOAT AS ict_index,
    player.value:starts::INT AS starts,
    player.value:expected_goals::FLOAT AS expected_goals,
    player.value:expected_assists::FLOAT AS expected_assists,
    player.value:expected_goal_involvements::FLOAT AS expected_goal_involvements,
    player.value:expected_goals_conceded::FLOAT AS expected_goals_conceded,
    player.value:influence_rank::FLOAT AS influence_rank,
    player.value:influence_rank_type::VARCHAR AS influence_rank_type,
    player.value:creativity_rank::INT AS creativity_rank,
    player.value:creativity_rank_type::VARCHAR AS creativity_rank_type,
    player.value:threat_rank::INT AS threat_rank,
    player.value:threat_rank_type::VARCHAR AS threat_rank_type,
    player.value:ict_index_rank::INT AS ict_index_rank,
    player.value:ict_index_rank_type::VARCHAR AS ict_index_rank_type,
    player.value:corners_and_indirect_freekicks_order::INT AS corners_and_indirect_freekicks_order,
    player.value:corners_and_indirect_freekicks_text::VARCHAR AS corners_and_indirect_freekicks_text,
    player.value:direct_freekicks_order::INT AS direct_freekicks_order,
    player.value:direct_freekicks_text::VARCHAR AS direct_freekicks_text,
    player.value:penalties_order::INT AS penalties_order,
    player.value:penalties_text::VARCHAR AS penalties_text,
    player.value:expected_goals_per_90::FLOAT AS expected_goals_per_90,
    player.value:saves_per_90::FLOAT AS saves_per_90,
    player.value:expected_assists_per_90::FLOAT AS expected_assists_per_90,
    player.value:expected_goal_involvements_per_90::FLOAT AS expected_goal_involvements_per_90,
    player.value:expected_goals_conceded_per_90::FLOAT AS expected_goals_conceded_per_90,
    player.value:goals_conceded_per_90::FLOAT AS goals_conceded_per_90,
    player.value:now_cost_rank::INT AS now_cost_rank,
    player.value:now_cost_rank_type::VARCHAR AS now_cost_rank_type,
    player.value:form_rank::INT AS form_rank,
    player.value:form_rank_type::FLOAT AS form_rank_type,
    player.value:points_per_game_rank::INT AS points_per_game_rank,
    player.value:points_per_game_rank_type::FLOAT AS points_per_game_rank_type,
    player.value:selected_rank::INT AS selected_rank,
    player.value:selected_rank_type::VARCHAR AS selected_rank_type,
    player.value:starts_per_90::FLOAT AS starts_per_90,
    player.value:clean_sheets_per_90::FLOAT AS clean_sheets_per_90
FROM
    {{source('raw','bootstrap_static')}},
    LATERAL FLATTEN(INPUT => elements) AS player